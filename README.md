# Калькулятор на C

## Что было сделано?

1. **Переделан `main.c` под новые требования:**
   - **Поддержка режима `--float`:**
     - Если программа запускается с флагом `--float`, вычисления выполняются в режиме вещественных чисел.
     - В этом режиме деление возвращает дробный результат, а ответ выводится в десятичной нотации.
   - **Проверка допустимых символов:**
     - Программа проверяет, что ввод содержит только символы из допустимого набора: `[0-9()*+/\s-]`.
     - Если встречается недопустимый символ, программа завершается с кодом возврата, отличным от 0.
   - **Обработка ошибок:**
     - Если выражение некорректно (например, несбалансированные скобки), программа завершается с кодом возврата, отличным от 0.
     - Если происходит деление на ноль или число меньшее, чем `1e-9` (в режиме `--float`), программа завершается с кодом возврата, отличным от 0.

2. **Unit-тесты:**
   - Написаны unit-тесты для проверки всех функций калькулятора с использованием Google Test.

3. **Интеграционные тесты:**
   - Написаны интеграционные тесты на Python для проверки работы калькулятора в целом.

4. **Makefile:**
   - Создан `Makefile` для автоматизации сборки, запуска тестов и очистки проекта.

---

## Как запускать/использовать?

### Запуск калькулятора:

1. **Сборка:**
make all
Это создаст `app.exe` в директории `build/`.

2. **Запуск в целочисленном режиме:**
make run-int
Введите выражение, например: `2 + 2`.

3. **Запуск в режиме с плавающей точкой:**
make run-float
Введите выражение, например: `10 / 3`.

### Запуск unit-тестов:

1. **Сборка и запуск:**
make run-unit-test
Это соберёт и запустит unit-тесты.

### Запуск интеграционных тестов:

1. **Создание виртуального окружения и запуск:**
make run-integration-tests
Это создаст виртуальное окружение, установит `pytest` и запустит интеграционные тесты.

### Очистка проекта:

1. **Удаление всех артефактов:**
make clean
Это удалит директории `build/`, `venv/` и `googletest/`.

---

## Как это было сделано?

### 1. **Google Test:**
- Для unit-тестов использовался Google Test. Он был клонирован из репозитория и собран с помощью CMake.
- Unit-тесты проверяют все функции калькулятора, включая обработку ошибок и корректность вычислений.

### 2. **Unit-тесты:**
- Написаны в файле `unittests.cpp`.
- Каждая функция калькулятора протестирована отдельно.
- Используются макросы Google Test, такие как `TEST`, `EXPECT_EQ`, `EXPECT_EXIT`.

### 3. **Интеграционные тесты:**
- Написаны на Python в файле `integration_tests.py`.
- Используется модуль `unittest` для проверки работы калькулятора в целом.
- Тесты проверяют корректность вычислений, обработку ошибок и работу в режиме `--float`.

### 4. **Makefile:**
- Создан для автоматизации сборки и тестирования.
- Поддерживает следующие цели:
  - `make all` — сборка калькулятора и unit-тестов.
  - `make run-int` — запуск калькулятора в целочисленном режиме.
  - `make run-float` — запуск калькулятора в режиме с плавающей точкой.
  - `make run-unit-test` — запуск unit-тестов.
  - `make run-integration-tests` — запуск интеграционных тестов.
  - `make clean` — очистка проекта.

